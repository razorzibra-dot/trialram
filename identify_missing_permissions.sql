-- ============================================================================
-- IDENTIFY MISSING PERMISSION IDS IN SEED.SQL
-- ============================================================================
-- This script identifies which permission IDs are referenced in role_permissions
-- but don't exist in the permissions table
-- ============================================================================

\echo '============================================================================'
\echo 'MISSING PERMISSION IDS ANALYSIS'
\echo '============================================================================'
\echo ''

-- Create temporary table with all permission IDs that should exist
CREATE TEMP TABLE expected_permissions AS
SELECT id::UUID FROM (VALUES
  ('00000000-0000-0000-0000-000000000001'),
  ('00000000-0000-0000-0000-000000000101'),
  ('00000000-0000-0000-0000-000000000102'),
  ('00000000-0000-0000-0000-000000000103'),
  ('00000000-0000-0000-0000-000000000104'),
  ('00000000-0000-0000-0000-000000000105'),
  ('00000000-0000-0000-0000-000000000201'),
  ('00000000-0000-0000-0000-000000000202'),
  ('00000000-0000-0000-0000-000000000203'),
  ('00000000-0000-0000-0000-000000000204'),
  ('00000000-0000-0000-0000-000000000301'),
  ('00000000-0000-0000-0000-000000000302'),
  ('00000000-0000-0000-0000-000000000303'),
  ('00000000-0000-0000-0000-000000000304'),
  ('00000000-0000-0000-0000-000000000401'),
  ('00000000-0000-0000-0000-000000000402'),
  ('00000000-0000-0000-0000-000000000403'),
  ('00000000-0000-0000-0000-000000000404'),
  ('00000000-0000-0000-0000-000000000501'),
  ('00000000-0000-0000-0000-000000000502'),
  ('00000000-0000-0000-0000-000000000601'),
  ('00000000-0000-0000-0000-000000000602'),
  ('00000000-0000-0000-0000-000000000701'),
  ('00000000-0000-0000-0000-000000000702'),
  ('00000000-0000-0000-0000-000000000801'),
  ('00000000-0000-0000-0000-000000000802'),
  ('00000000-0000-0000-0000-000000000901'),
  ('00000000-0000-0000-0000-000000000902'),
  ('00000000-0000-0000-0000-000000001001'),
  ('00000000-0000-0000-0000-000000001002'),
  ('00000000-0000-0000-0000-000000001003'),
  ('00000000-0000-0000-0000-000000001004'),
  ('00000000-0000-0000-0000-000000001005'),
  ('00000000-0000-0000-0000-000000001006')
) AS t(id);

\echo 'Expected Permissions (from seed.sql lines 14-48):'
SELECT * FROM expected_permissions ORDER BY id;

\echo ''
\echo 'Actual Permissions in Database:'
SELECT id, name, resource, action FROM permissions ORDER BY id;

\echo ''
\echo 'Missing Permissions (Expected but not in DB):'
SELECT ep.id
FROM expected_permissions ep
LEFT JOIN permissions p ON ep.id = p.id
WHERE p.id IS NULL
ORDER BY ep.id;

\echo ''
\echo 'Extra Permissions (In DB but not expected):'
SELECT p.id, p.name
FROM permissions p
LEFT JOIN expected_permissions ep ON p.id = ep.id
WHERE ep.id IS NULL
ORDER BY p.id;

\echo ''
\echo '============================================================================'
\echo 'ANALYSIS COMPLETE'
\echo '============================================================================'

DROP TABLE expected_permissions;
